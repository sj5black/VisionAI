<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VisionAI - 이미지 객체 탐지</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <main class="container">
      <header class="header">
        <h1>VisionAI 객체 탐지 & 행동 예측</h1>
        <p class="subtitle">이미지를 업로드하면 포함된 사물/동물을 탐지하고, 동물의 감정/자세/행동을 분석합니다.</p>
      </header>

      <section class="card">
        <form id="uploadForm" class="form">
          <div class="row">
            <label class="label" for="image">이미지</label>
            <input id="image" name="image" type="file" accept="image/*" required />
          </div>

          <div class="row">
            <label class="label" for="model">모델</label>
            <select id="model" name="model">
              <option value="visionai_pipeline" selected>🆕 VisionAI Pipeline (YOLOv8 + 감정/행동 분석)</option>
              <option value="fasterrcnn_resnet50_fpn_v2">Faster R-CNN (ResNet50)</option>
              <option value="retinanet_resnet50_fpn_v2">RetinaNet (ResNet50)</option>
            </select>
          </div>

          <div class="row">
            <label class="label" for="threshold">임계값(Threshold)</label>
            <input id="threshold" name="threshold" type="number" min="0" max="1" step="0.05" value="0.5" />
            <span class="hint">0~1, 높을수록 더 확실한 탐지만 표시</span>
          </div>

          <div class="row">
            <label class="label" for="max_detections">최대 탐지 수</label>
            <input id="max_detections" name="max_detections" type="number" min="1" max="300" step="1" value="100" />
          </div>

          <div class="row actions">
            <button id="submitBtn" type="submit">분석하기</button>
            <span id="status" class="status"></span>
          </div>
        </form>
      </section>

      <section class="grid">
        <div class="card">
          <h2>원본</h2>
          <div class="imageWrap">
            <img id="originalImg" alt="원본 이미지" />
          </div>
        </div>

        <div class="card">
          <h2>탐지 결과(박스)</h2>
          <div class="imageWrap">
            <img id="annotatedImg" alt="탐지 결과 이미지" />
          </div>
        </div>
      </section>

      <section class="card">
        <h2>탐지된 객체 종류</h2>
        <div id="types" class="chips"></div>

        <div id="animalNotice" class="notice" style="display: none"></div>

        <h2 class="mt">상세 목록</h2>
        <div id="tableWrap"></div>
        
        <div id="pipelineInfo" class="notice" style="display: none; margin-top: 1rem;">
          <b>VisionAI Pipeline</b> 사용 시 추가 정보:
          <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
            <li><b>감정</b>: relaxed, alert, fearful, aggressive, playful</li>
            <li><b>자세</b>: sitting, standing, lying, running, jumping</li>
            <li><b>행동 예측</b>: 다음 5초 이내 예상 행동</li>
          </ul>
          처리 시간: <span id="processingTime">-</span>초
        </div>
      </section>
    </main>

    <!-- cache-busting: ensure clients load latest JS -->
    <script src="/static/app.js?v=2"></script>
  </body>
</html>

